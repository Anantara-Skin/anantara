import e from"./core/ComponentRegistry.js";import t from"./services/DataLayer.js";import{browserInfo as o,isIOS as n,applePay as s}from"./core/shims/support.js";import{lazysizes as i}from"./vendors/lazysizes.js";import{AOS as r}from"./vendors/aos.js";import"./vendors/loadjs.js";import{Event as a}from"./services/EventEmitter.js";import{deepMerge as l}from"./toolbox/deepMerge.js";import{mediaQuery as d}from"./toolbox/mediaQuery.js";import{on as c}from"./toolbox/event.js";import"./stores/ProductServiceStore.js";import"./core/ModalManager.js";import{debounce as m}from"./toolbox/debounce.js";import{throttle as u}from"./toolbox/throttle.js";window.lora=window.lora||{};const p="m-scroll-blocked",w="h-layout-full-screen-absolute";let b=0,f=!0;function g(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}function y(){!function(){const e=window.history.pushState,t=window.history.replaceState;window.history.pushState=function(...t){if("function"==typeof window.onpushstate){const e=t[0];window.onpushstate({state:e})}return e.apply(this,t)},window.history.replaceState=function(...e){if("function"==typeof window.onreplacestate){const t=e[0];window.onreplacestate({state:t})}return t.apply(this,e)}}(),document.addEventListener("lazybeforeunveil",e=>{const t=e.target.getAttribute("data-bg");t&&(e.target.style.backgroundImage=`url('${t}')`)}),window.addEventListener("pageshow",e=>{if(e.persisted){"cart"===(t.getData().page.id||{})&&window.location.reload()}}),a.on("page.scroll.disabled",(e=!1)=>{(d.is("medium down")||n())&&(b=document.documentElement.scrollTop,window.scrollTo(0,0),document.documentElement.classList.add(p)),e&&document.documentElement.classList.add(p),f=!1},this),a.on("page.scroll.enabled",(e={})=>{e.isUnblockScrollForAll&&document.documentElement.classList.remove(p),(d.is("medium down")||n())&&(document.documentElement.classList.remove(p),e.isInstantScroll?window.scroll({top:b,behavior:"instant"}):window.scrollTo(0,b)),f=!0},this),a.on("full.screen.absolute.enabled",(e={})=>{document.body.classList.add(w),"function"==typeof e.onEnable&&setTimeout(()=>{e.onEnable()},100)},this),a.on("full.screen.absolute.disabled",()=>{document.body.classList.remove(w)},this),c("resize",window,m(()=>{g(),a.emit("page.resized",!0)},300)),c("scroll",window,u(()=>{a.emit("page.scrolled",!0)},300),{passive:!0}),c("beforeunload",window,()=>{!d.is("medium down")&&!n()||f||a.emit("page.scroll.enabled",{isUnblockScrollForAll:!0,isInstantScroll:!0})})}function h(){y(),s()||document.body.classList.add("no-apple-pay"),g(),e.run(),d._init(),i.init(),r.init({startEvent:"DOMContentLoaded",once:!0}),Object.defineProperty(window,"loraDataLayer",{get:()=>t.getData()})}function v(){/debug/.test(window.location.search)&&(window.lora.debug=!0),function(){const e="Firefox"===o().name;document.querySelectorAll("img").forEach(t=>{const o=t.parentNode.querySelector("source"),n=t.hasAttribute("data-srcset");(e&&o||n)&&(t.removeAttribute("width"),t.removeAttribute("height"))})}(),function(){if(!n())return;const e=document.querySelector('meta[name="viewport"]'),t=e.getAttribute("content"),o=/(user-scalable=[\w]+)/i;t.match(o)?e.setAttribute("content",t.replace(o,"user-scalable=no")):e.setAttribute("content",t.concat(", user-scalable=no"))}(),t.initialize(),(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?h():document.addEventListener("DOMContentLoaded",h)}window.lora=l(window.lora,{version:"80.5.0",buildVersion:"790",mountedComponents:e.mountedComponents,getComponentsByName:e.getComponentsByName.bind(e),getComponent:e.getComponent.bind(e),toolkit:()=>import("./core/debug/Toolkit.js").then(()=>{window.lora.debug&&console.log("Toolkit loaded")})}),v();
