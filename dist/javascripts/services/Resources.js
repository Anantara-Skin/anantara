import{ajax as t}from"../toolbox/ajax.js";import{stringify as e}from"../toolbox/queryString.js";let n=null;function r(){return n?Promise.resolve(n):new Promise((e,r)=>{const o=document.querySelector('head meta[name="pageResourcesUrl"]');let l;return o&&(l=o.getAttribute("content")),t(l).then(t=>{n=t,e(n)}).catch(r)})}function o(r={}){const{dataType:o="html",section:l,id:u}=r,s=`${n.urls.COMPONENT_SVC_HTML}-${l}_${u}`,a=`${n.urls.COMPONENT_SVC_JSON}-${l}_${u}`;delete r.dataType;const c=e(r,!0);let i="";return r.reloadUrl?i=r.reloadUrl:"html"===o?i=s.indexOf("?")>-1?`${s}&${c}`:`${s}?${c}`:"json"===o&&(i=`${a}?${c}`),t(i).then(t=>{const e={};return e.content=t,e.dataType=o,e})}function l(){return t(n.urls.CSRF).then(t=>t&&t.token?t:null)}export{l as fetchCSRF,o as fetchContent,r as getResources};
